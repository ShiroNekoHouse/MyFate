import numpy as np
import threading
#from federatedml.ftl.encryption import mulmatOT
import mulmatOT
import sys,getopt
import socket
import pickle
from time import *

BITS_LEN=16
ROW_A=6
COL_A=6
ROW_B=6
COL_B=6

# a=np.array([[ 0.00514600],
#  [ 0.02252000],
#  [-0.01941000],
#  [ 0.04263000],
#  [-0.01234000],
#  [ 0.00293600]])
b=np.array([[9.11100000e-02,9.75300000e-01,2.48500000e-02,9.99900000e-01,9.99900000e-01,9.22400000e-02],
 [9.97800000e-01,1.06200000e-02,2.26100000e-01,1.81900000e-03,4.35400000e-01,2.93100000e-01],
 [9.93200000e-01,7.00700000e-01,4.09000000e-03,5.53100000e-01,1.94200000e-01,4.91300000e-01],
 [2.14800000e-01,6.46900000e-01,3.31300000e-01,6.51400000e-01,6.66900000e-01,4.70700000e-01],
 [9.95100000e-01,9.54300000e-01,7.41300000e-01,9.96100000e-01,5.02900000e-02,7.40100000e-02],
 [2.47100000e-01,9.99900000e-01,9.83900000e-03,6.57200000e-01,7.32900000e-02,8.37100000e-04]])
# a=np.array([[-100.1,2087,378.1],[-408.1,560.1,600.8]])
# b=np.array([[9.11100000e-02,9.75300000e-01],[2.48500000e-02,9.99900000e-01]])

# a=np.array([[-100.1,2087,378.1,200.-1,376.6,5801],[-408.1,560.1,600.8,5007,-108.6,250.8]])
# b=np.array([[145.5,27.71],[307.1,-49.01],[550.1,652.1],[-30.01,400.1],[370.1,-405.1],[308.9,470.1]])
# a=np.array([[9.11183649e-09,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.11183649e-09,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07]])
# a=a.transpose()
# b=np.array([[9.11183649e-09,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.11183649e-09,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07],
#  [9.97868177e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,9.97868177e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01],
#  [9.93293351e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,9.93293351e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01],
#  [2.14898568e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,2.14898568e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01],
#  [9.95129221e-01,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.95129221e-01,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02],
#  [2.47149265e-01,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,2.47149265e-01,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04],
#  [9.11183649e-09,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.11183649e-09,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07],
#  [9.97868177e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,9.97868177e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01],
#  [9.93293351e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,9.93293351e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01],
#  [2.14898568e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,2.14898568e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01],
#  [9.95129221e-01,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.95129221e-01,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02],
#  [2.47149265e-01,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,2.47149265e-01,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04],
#  [9.11183649e-09,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.11183649e-09,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07],
#  [9.97868177e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,9.97868177e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01],
#  [9.93293351e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,9.93293351e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01],
#  [2.14898568e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,2.14898568e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01],
#  [9.95129221e-01,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.95129221e-01,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02],
#  [2.47149265e-01,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,2.47149265e-01,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04],
#  [9.11183649e-09,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.11183649e-09,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07],
#  [9.97868177e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,9.97868177e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01],
#  [9.93293351e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,9.93293351e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01],
#  [2.14898568e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,2.14898568e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01],
#  [9.95129221e-01,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.95129221e-01,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02],
#  [2.47149265e-01,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,2.47149265e-01,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04],
#  [9.11183649e-09,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.11183649e-09,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07,9.75335508e-01,2.48583458e-09,9.99946741e-01,9.99953763e-01,9.22442917e-07],
#  [9.97868177e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,9.97868177e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01,1.06257031e-02,2.26146074e-01,1.81942443e-03,4.35402792e-01,2.93155487e-01],
#  [9.93293351e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,9.93293351e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01,7.00731607e-01,4.09086882e-03,5.53100605e-01,1.94269353e-01,4.91364907e-01],
#  [2.14898568e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,2.14898568e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01,6.46915583e-01,3.31391350e-01,6.51451235e-01,6.66928566e-01,4.70721486e-01],
#  [9.95129221e-01,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.95129221e-01,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02,9.54346714e-01,7.41353410e-01,9.96145008e-01,5.02976012e-02,7.40109476e-02],
#  [2.47149265e-01,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,2.47149265e-01,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04,9.99999985e-01,9.83987704e-03,6.57201027e-01,7.32935665e-02,8.37128700e-04]])
a=b
# a=np.array([[1,2,-3],[4,5,6]])
# b=np.array([[1,-2],[3,4],[5,6]])
# a=np.array([[ 0.00514600],
#  [ 0.02252000],
#  [-0.01941000],
#  [ 0.04263000],
#  [-0.01234000],
#  [ 0.00514600],
#  [ 0.02252000],
#  [-0.01941000],
#  [ 0.04263000],
#  [-0.01234000],
#  [ 0.00514600],
#  [ 0.00514600]])
# b=np.array([[9.11100000e-02,9.75300000e-01,2.48500000e-02,9.99900000e-01,9.99900000e-01,9.22400000e-02,9.75300000e-01,2.48500000e-02,9.99900000e-01,9.99900000e-01,9.22400000e-02,9.75300000e-01],
#  [9.97800000e-01,1.06200000e-02,2.26100000e-01,1.81900000e-03,4.35400000e-01,2.93100000e-01,1.06200000e-02,2.26100000e-01,1.81900000e-03,4.35400000e-01,2.93100000e-01,1.06200000e-02],
#  [9.93200000e-01,7.00700000e-01,4.09000000e-03,5.53100000e-01,1.94200000e-01,4.91300000e-01,7.00700000e-01,4.09000000e-03,5.53100000e-01,1.94200000e-01,4.91300000e-01,7.00700000e-01],
#  [2.47100000e-01,9.99900000e-01,9.83900000e-03,6.57200000e-01,7.32900000e-02,8.37100000e-04,9.99900000e-01,9.83900000e-03,6.57200000e-01,7.32900000e-02,8.37100000e-04,9.99900000e-01]])
print(a.shape)
print(b.shape)

def send_expand_matrix(ROW,COL,matrix):
    matrixInt,matrixIntTimes=mulmatOT.ChaneToInt(ROW,COL,matrix)
    return [ROW,COL,matrixIntTimes]

def receive_expand_matrix(msg):
    return msg

def mainx(argv):
    try:
        opts, args = getopt.getopt(argv,"hr:")
    except getopt.GetoptError:
        print ('xxx.py -r (0 or 1)')
        sys.exit(2)
    for opt, arg in opts:
        if opt == '-h':
            print ('xxx.py -r (0 or 1)')
            sys.exit()
        elif opt in ("-r"):
            role = int(arg)
    begin_time=time()
    
    msgfromA=send_expand_matrix(ROW_A,COL_A,a)
    expandsA=receive_expand_matrix(msgfromA)
    msgfromB=send_expand_matrix(ROW_B,COL_B,b)
    expandsB=receive_expand_matrix(msgfromB)
    #fff=np.matmul(b,a)
    fff=b*a
    print(fff)
    
    if role==0:
        res1=mulmatOT.mulmatOT_wise(0,7891,b,expandsA,ROW_B,COL_B)
        print("------------------result------------------")
        print(res1)
        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        s.bind(('127.0.0.1', 9999))
        message, address = s.recvfrom(1024)
        res2=pickle.loads(message)
        print("------------------res2------------------")
        print(res2)
        res3=res1+res2
        print("------------------res3------------------")
        print(res3)
        res4=res3-fff
        print("------------------res4------------------")
        print(res4)
        

    else:
        res2=mulmatOT.mulmatOT_wise(1,7891,a,expandsB,ROW_A,COL_A)
        print("------------------result------------------")
        print(res2)
        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        s.bind(('127.0.0.1', 9998))
        host = '127.0.0.1' # 获取本地主机名
        port = 9999                # 设置端口号
        message=pickle.dumps(res2)
        Addr=(host,port)
        s.sendto(message,Addr)
    
    end_time=time()
    run_time=end_time-begin_time
    print(run_time)
    

def handle1(sid):
    msgfromA=send_expand_matrix(ROW_A,COL_A,a)
    expandsA=receive_expand_matrix(msgfromA)
    print("Thread %d run"%sid)
    res1=mulmatOT.mulmatOT(0,b,expandsA,ROW_B,COL_B)
    print("------------------result------------------")
    print(res1)

def handle2(sid):
    msgfromB=send_expand_matrix(ROW_B,COL_B,b)
    expandsB=receive_expand_matrix(msgfromB)
    print("Thread %d run"%sid)
    res2=mulmatOT.mulmatOT(1,a,expandsB,ROW_A,COL_A)
    print("------------------result------------------")
    print(res2)
#创建线程方法1


if __name__ == "__main__":
    # t1 = threading.Thread(target=handle1, args=(1,))
    # t1.start()
    # t2 = threading.Thread(target=handle2, args=(2,))
    # t2.start()
    mainx(sys.argv[1:])
        
